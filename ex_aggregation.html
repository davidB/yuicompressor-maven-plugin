<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Jan 26, 2014 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
      <meta name="author" content="David Bernard" />
    <meta name="Date-Revision-yyyymmdd" content="20140126" />
    <meta http-equiv="Content-Language" content="en" />
        
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18659445-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>    
  </head>
  <body class="composite">
    <div id="banner">
                  <a href="./" id="bannerLeft">
                YUI Compressor Maven Mojo
                </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                
                <div class="xleft">
        <span id="publishDate">Last Published: 2014-01-26 20:49</span>
                  &nbsp;| <span id="projectVersion">Version: 1.4.0</span>
                      </div>
            <div class="xright">                    <a href="./" title="changelog/scm">changelog/scm</a>
              
                
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="index.html#Distribution" title="Distribution">Distribution</a>
            </li>
                  <li class="none">
                          <a href="plugin-info.html" title="Goals">Goals</a>
            </li>
                  <li class="none">
                          <a href="usage_compress.html" title="Usage: compress">Usage: compress</a>
            </li>
                  <li class="none">
                          <a href="usage_jslint.html" title="Usage: jslint">Usage: jslint</a>
            </li>
          </ul>
                       <h5>Examples</h5>
                  <ul>
                  <li class="none">
            <strong>Aggregate</strong>
          </li>
                  <li class="none">
                          <a href="ex_gzip.html" title="Gzip">Gzip</a>
            </li>
                  <li class="none">
                          <a href="ex_failOnWarning.html" title="Fail on warning">Fail on warning</a>
            </li>
          </ul>
                       <h5>Links</h5>
                  <ul>
                  <li class="none">
                          <a href="http://developer.yahoo.com/yui/compressor/" class="externalLink" title="YUI Compressor">YUI Compressor</a>
            </li>
                  <li class="none">
                          <a href="http://jslint.com/" class="externalLink" title="JSLint">JSLint</a>
            </li>
                  <li class="none">
                          <a href="links.html" title="Others...">Others...</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                        <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                              <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                                                                                                                   <a href="http://www.pledgie.com/campaigns/13361" title="Click here to lend your support to: yuicompressor-maven-plugin and make a donation at www.pledgie.com !" class="poweredBy">
        <img class="poweredBy"  alt="Click here to lend your support to: yuicompressor-maven-plugin and make a donation at www.pledgie.com !" src="http://www.pledgie.com/campaigns/13361.png?skin_name=chrome"    />
      </a>
                                                                                                          <a href="http://maven.apache.org" title="Build with Maven 2" class="poweredBy">
        <img class="poweredBy"  alt="Build with Maven 2" src="images/logos/maven-feather.png"    />
      </a>
                                                                                                    <a href="http://creativecommons.org/licenses/LGPL/2.1/" title="CC-GNU LGPL" class="poweredBy">
        <img class="poweredBy"  alt="CC-GNU LGPL" src="http://creativecommons.org/images/public/cc-LGPL-a.png"    />
      </a>
                       
                
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        

 <div class="section"><h2>Aggregation<a name="Aggregation"></a></h2>
<p>Good practice :
</p><ul>
<li>on web, is to download/call one big js file instead of several small files.</li>
<li>in source code organisation is to have unit file (with one &quot;concern&quot;).</li>
</ul>

<p>The major js and css framework/lib provide source code in both version (one big, lot of small), or provide a online tool to generate the big.</p>
<p>The following option allow you to use/store small files into your source and generate the big at build time. The aggregation is done after yuicompression</p> 

<div class="section"><h3>Basic sample<a name="Basic_sample"></a></h3>
<p>To Compress every js and css files and aggregate every js file under ${project.build.directory}/${project.build.finalName}/static/ into all.js :
</p><div class="source"><pre>
&lt;project&gt;
...
  &lt;build&gt;
    &lt;plugins&gt;
...
      &lt;plugin&gt;
        &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt;
        &lt;artifactId&gt;yuicompressor-maven-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;compress&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;        
        &lt;configuration&gt;
          &lt;nosuffix&gt;true&lt;/nosuffix&gt;
          &lt;aggregations&gt;
            &lt;aggregation&gt;
              &lt;!-- remove files after aggregation (default: false)
              &lt;removeIncluded&gt;true&lt;/removeIncluded&gt;
              --&gt;
              &lt;!-- insert new line after each concatenation (default: false) --&gt;
              &lt;insertNewLine&gt;true&lt;/insertNewLine&gt;
              &lt;output&gt;${project.build.directory}/${project.build.finalName}/static/all.js&lt;/output&gt;
              &lt;!-- files to include, path relative to output's directory or absolute path--&gt;
              &lt;!--inputDir&gt;base directory for non absolute includes, default to parent dir of output&lt;/inputDir--&gt;
              &lt;includes&gt;
                &lt;include&gt;${basedir}/src/licenses/license.js&lt;/include&gt;
                &lt;include&gt;**/*.js&lt;/include&gt;
              &lt;/includes&gt;
              &lt;!-- files to exclude, path relative to output's directory
              &lt;excludes&gt;
                &lt;exclude&gt;**/*.pack.js&lt;/exclude&gt;
                &lt;exclude&gt;**/compressed.css&lt;/exclude&gt;
              &lt;/excludes&gt;
              --&gt;
            &lt;/aggregation&gt;
          &lt;/aggregations&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
...
    &lt;/plugins&gt;
  &lt;/build&gt;
...
&lt;/project&gt;
 </pre></div>

</div>

<div class="section"><h3>Removing included files<a name="Removing_included_files"></a></h3>
<p>Using removeIncluded option, remove file, but the war plugin will then add file.
So if you want to remove file after aggregation and don't want war plugin copy them, then you need to use warSourceExcludes :
</p><div class="source"><pre>
&lt;project&gt;
...
  &lt;build&gt;
    &lt;plugins&gt;
...
      &lt;plugin&gt;
        &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt;
        &lt;artifactId&gt;yuicompressor-maven-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;compress&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;        
        &lt;configuration&gt;
          &lt;nosuffix&gt;true&lt;/nosuffix&gt;
          &lt;aggregations&gt;
           &lt;aggregation&gt;
              &lt;!-- remove files after aggregation (default: false) --&gt;
              &lt;removeIncluded&gt;true&lt;/removeIncluded&gt;
              &lt;!-- insert new line after each concatenation (default: false) --&gt;
              &lt;insertNewLine&gt;true&lt;/insertNewLine&gt;
              &lt;output&gt;${project.build.directory}/${project.build.finalName}/static/all-2.js&lt;/output&gt;
              &lt;!-- files to include, path relative to output's directory --&gt;
              &lt;includes&gt;
                &lt;include&gt;toAggregateAndRemove/**.js&lt;/include&gt;
              &lt;/includes&gt;
            &lt;/aggregation&gt;
          &lt;/aggregations&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
...
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;warSourceExcludes&gt;**/toAggregateAndRemove/**&lt;/warSourceExcludes&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
...
    &lt;/plugins&gt;
  &lt;/build&gt;
...
&lt;/project&gt;
 </pre></div>

</div>
<div class="section"><h3>Adding header (copyright)<a name="Adding_header_copyright"></a></h3>
<p>When aggregating minified js files, the copyright headers have been stripped out which is fine because we don't want to repeat it several times in the output file.
However it would be great to be able to insert one at beginning of output file.
</p>
<p>For simple cases, the maven-license-plugin is enough if you use the same header for all files but it is not enough if you want to have a different header per aggregation (different libraries with different licensing schemes).</p>
<ol style="list-style-type: decimal">
<li>you put license header in its own file (ex license_js.txt)</li>
<li>aggregate a license header to minified files.</li>
</ol>
<div class="source"><pre>
  &lt;includes&gt;
    &lt;include&gt;${project.build.sourceDirectory}/../webapp/js/mylib/copyright.txt&lt;/include&gt;
    &lt;include&gt;mylib/**/*.js&lt;/include&gt;
  &lt;/includes&gt;
 </pre></div>

</div>
<div class="section"><h3>Adding filename headers<a name="Adding_filename_headers"></a></h3>
<p>When aggregating minified js or css files, the file headers have been stripped out.
However it would be great to be able to easily identify the corresponding input files when looking at the aggregated file.
</p><div class="source"><pre>
&lt;project&gt;
...
  &lt;build&gt;
    &lt;plugins&gt;
...
      &lt;plugin&gt;
        &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt;
        &lt;artifactId&gt;yuicompressor-maven-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;compress&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;aggregations&gt;
           &lt;aggregation&gt;
              &lt;!-- insert new line after each concatenation (default: false) --&gt;
              &lt;insertNewLine&gt;true&lt;/insertNewLine&gt;
              &lt;!-- insert file header before each aggregated file (default: false) --&gt;
              &lt;insertFileHeader&gt;true&lt;/insertFileHeader&gt;
              &lt;output&gt;${project.build.directory}/${project.build.finalName}/static/all-3.js&lt;/output&gt;
              &lt;!-- files to include, path relative to output's directory --&gt;
              &lt;includes&gt;
                &lt;include&gt;**/*.js&lt;/include&gt;
              &lt;/includes&gt;
            &lt;/aggregation&gt;
          &lt;/aggregations&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
...
    &lt;/plugins&gt;
  &lt;/build&gt;
...
&lt;/project&gt;
 </pre></div>

</div>
<div class="section"><h3>Automatically exclude wildcard matches that were included in previous aggregations<a name="Automatically_exclude_wildcard_matches_that_were_included_in_previous_aggregations"></a></h3>
<p>When multiple aggregations are defined for the same type of file, such as css, it can be tedious to maintain matching exclusions on the final aggregation which uses a wildcard inclusion.
It would be convenient to automatically exclude wildcard matches that have been included in previous aggregations.
</p><div class="source"><pre>
&lt;project&gt;
...
  &lt;build&gt;
    &lt;plugins&gt;
...
      &lt;plugin&gt;
        &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt;
        &lt;artifactId&gt;yuicompressor-maven-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;compress&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;aggregations&gt;
           &lt;aggregation&gt;
              &lt;output&gt;${project.build.directory}/${project.build.finalName}/static/IE.css&lt;/output&gt;
              &lt;!-- files to include, path relative to output's directory --&gt;
              &lt;includes&gt;
                &lt;include&gt;**/IE*.css&lt;/include&gt;
              &lt;/includes&gt;
            &lt;/aggregation&gt;
           &lt;aggregation&gt;
              &lt;!-- exclude any wildcard matches that have been included by prior aggregations (default: false) --&gt;
              &lt;autoExcludeWildcards&gt;true&lt;/autoExcludeWildcards&gt;
              &lt;output&gt;${project.build.directory}/${project.build.finalName}/static/everything-except-IE.css&lt;/output&gt;
              &lt;!-- files to include, path relative to output's directory --&gt;
              &lt;includes&gt;
                &lt;include&gt;**/*.css&lt;/include&gt;
              &lt;/includes&gt;
            &lt;/aggregation&gt;
          &lt;/aggregations&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
...
    &lt;/plugins&gt;
  &lt;/build&gt;
...
&lt;/project&gt;
 </pre></div>

</div>
</div>


      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">Copyright &#169;                   2012-2014.
          All Rights Reserved.      
                
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
